# Sales Service
Сервис предоставляет управление продажами в сети магазинов бытовой техники.

## Запуск проекта
### Локально (Иметь установленный PostgreSQL, либо запущенный в Docker)
1. Создать .env файл и вставить значения из ```./configs/.env.example```, либо изменить дефолтные значения в файле ```./configs/settings.py```
2. Перейти в директорию с сервисом:
   ```sh
   cd ./sales_service
3. Выполнить команду:
   ```sh
   python ./main.py
### Docker
1. Перейти в корневую директорию проекта.
2. Выполнить команду:
   ```sh
   docker compose up --build

## Описание работы API
### City
#### 1. Создание города
- **Метод**: `POST`
- **URL**: `http://localhost:80/api/v1/city/`
- **Тело запроса** (JSON):
    ```json
    {
        "name": "Владивосток"
    }
    ```
#### 2. Получение списка городов
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/city/`
- **Параметры запроса**:
    - `page`: номер страницы (например, `1`)
    - `size`: размер страницы (например, `10`)
#### 3. Обновление города
- **Метод**: `PUT`
- **URL**: `http://localhost:80/api/v1/city/`
- **Тело запроса** (JSON):
    ```json
    {
        "name": "Новое имя"
    }
    ```
#### 4. Удаление города
- **Метод**: `DELETE`
- **URL**: `http://localhost:80/api/v1/city/`
- **Тело запроса** (JSON):
    ```json
    {
        "id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 5. Получение города по ID
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/city/`
- **Параметры запроса**:
    - `city_id`: идентификатор города (например, `1b30aff2-ef49-464d-a573-707953169302`)
### Product
#### 1. Создание товара
- **Метод**: `POST`
- **URL**: `http://localhost:80/api/v1/product/`
- **Тело запроса** (JSON):
    ```json
    {
        "name": "Пылесос",
        "description": "Описание товара",
        "price": 0,
        "store_id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 2. Получение списка товаров
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/product/`
- **Параметры запроса**:
    - `page`: номер страницы (например, `1`)
    - `size`: размер страницы (например, `10`)
#### 3. Обновление товара
- **Метод**: `PUT`
- **URL**: `http://localhost:80/api/v1/product/`
- **Тело запроса** (JSON):
    ```json
    {
        "name": "Новое имя",
        "description": "Новое описание",
        "price": 10,
        "store_id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 4. Удаление товара
- **Метод**: `DELETE`
- **URL**: `http://localhost:80/api/v1/product/`
- **Тело запроса** (JSON):
    ```json
    {
        "id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 5. Получение товара по ID
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/product/`
- **Параметры запроса**:
    - `product_id`: идентификатор товара (например, `1b30aff2-ef49-464d-a573-707953169302`)
### Sales
#### 1. Создание продажи
- **Метод**: `POST`
- **URL**: `http://localhost:80/api/v1/sales/`
- **Тело запроса** (JSON):
    ```json
    {
        "store_id": "1b30aff2-ef49-464d-a573-707953169302",
        "city_id": "1b30aff2-ef49-464d-a573-707953169302",
        "products": [
          "1b30aff2-ef49-464d-a573-707953169302"
        ]
    }
    ```
#### 2. Получение списка продаж
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/sales/`
- **Параметры запроса**:
    - `page`: номер страницы (например, `1`)
    - `size`: размер страницы (например, `10`)
    - `city`: идентификатор города (например, `1b30aff2-ef49-464d-a573-707953169302`)
    - `store`: идентификатор магазина (например, `1b30aff2-ef49-464d-a573-707953169302`)
    - `product`: идентификатор товара (например, `1b30aff2-ef49-464d-a573-707953169302`)
    - `days`: продажи за последние N дней (например, `5`)
    - `price`: продажи с суммой меньше price (например, `-5000`) или с суммой больше price (например, `5000`)
    - `amount`: продажи с количеством товаром меньше amount (например, `-5`) или больше amount (например, `5`)
#### 3. Обновление продажи
- **Метод**: `PUT`
- **URL**: `http://localhost:80/api/v1/sales/`
- **Тело запроса** (JSON):
    ```json
    {
        "store_id": "1b30aff2-ef49-464d-a573-707953169302",
        "city_id": "1b30aff2-ef49-464d-a573-707953169302",
        "products": [
          "1b30aff2-ef49-464d-a573-707953169302"
        ],
        "id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 4. Удаление продажи
- **Метод**: `DELETE`
- **URL**: `http://localhost:80/api/v1/sales/`
- **Тело запроса** (JSON):
    ```json
    {
        "id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 5. Получение продажи по ID
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/sales/`
- **Параметры запроса**:
    - `sale_id`: идентификатор товара (например, `1b30aff2-ef49-464d-a573-707953169302`)
### Store
#### 1. Создание магазина
- **Метод**: `POST`
- **URL**: `http://localhost:80/api/v1/store/`
- **Тело запроса** (JSON):
    ```json
    {
        "name": "string",
        "city_id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 2. Получение списка магазинов
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/store/`
- **Параметры запроса**:
    - `page`: номер страницы (например, `1`)
    - `size`: размер страницы (например, `10`)
#### 3. Обновление магазина
- **Метод**: `PUT`
- **URL**: `http://localhost:80/api/v1/store/`
- **Тело запроса** (JSON):
    ```json
    {
        "name": "Новое имя",
        "city_id": "1b30aff2-ef49-464d-a573-707953169302",
        "id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 4. Удаление магазина
- **Метод**: `DELETE`
- **URL**: `http://localhost:80/api/v1/store/`
- **Тело запроса** (JSON):
    ```json
    {
        "id": "1b30aff2-ef49-464d-a573-707953169302"
    }
    ```
#### 5. Получение магазина по ID
- **Метод**: `GET`
- **URL**: `http://localhost:80/api/v1/store/`
- **Параметры запроса**:
    - `store_id`: идентификатор товара (например, `1b30aff2-ef49-464d-a573-707953169302`)
 
## Используемые технологии
| Компонент                       | Технология                               |
|---------------------------------|------------------------------------------|
| **Фреймворк для Sales Service** | [FastAPI](https://fastapi.tiangolo.com/) |
| **Веб-сервер**                  | [Nginx](https://www.nginx.com/)          |
| **База данных**                 | [PostgreSQL](https://www.postgresql.org/)|
| **Контейнеризация**             | [Docker](https://www.docker.com/)        |
